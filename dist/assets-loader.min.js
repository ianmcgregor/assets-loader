!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.assetsLoader=e()}}(function(){return function e(t,r,n){function s(i,a){if(!r[i]){if(!t[i]){var u="function"==typeof require&&require;if(!a&&u)return u(i,!0);if(o)return o(i,!0);var c=new Error("Cannot find module '"+i+"'");throw c.code="MODULE_NOT_FOUND",c}var l=r[i]={exports:{}};t[i][0].call(l.exports,function(e){var r=t[i][1][e];return s(r?r:e)},l,l.exports,e,t,r,n)}return r[i].exports}for(var o="function"==typeof require&&require,i=0;i<n.length;i++)s(n[i]);return s}({1:[function(e,t,r){"use strict";t.exports=function(){try{return!!new Blob}catch(e){return!1}}()},{}],2:[function(e,t,r){"use strict";function n(){s.call(this),this.setMaxListeners(20)}var s=e("./events").EventEmitter;n.prototype=Object.create(s.prototype),n.prototype.constructor=n,n.prototype.off=function(e,t){return t?this.removeListener(e,t):e?this.removeAllListeners(e):this.removeAllListeners()},t.exports=n},{"./events":3}],3:[function(e,t,r){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function s(e){return"function"==typeof e}function o(e){return"number"==typeof e}function i(e){return"object"==typeof e&&null!==e}function a(e){return void 0===e}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!o(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,r,n,o,u,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if(t=arguments[1],t instanceof Error)throw t;var l=new Error('Uncaught, unspecified "error" event. ('+t+")");throw l.context=t,l}if(r=this._events[e],a(r))return!1;if(s(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:o=Array.prototype.slice.call(arguments,1),r.apply(this,o)}else if(i(r))for(o=Array.prototype.slice.call(arguments,1),c=r.slice(),n=c.length,u=0;u<n;u++)c[u].apply(this,o);return!0},n.prototype.addListener=function(e,t){var r;if(!s(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,s(t.listener)?t.listener:t),this._events[e]?i(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,i(this._events[e])&&!this._events[e].warned&&(r=a(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,r&&r>0&&this._events[e].length>r&&(this._events[e].warned=!0,"function"==typeof console.trace)),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function r(){this.removeListener(e,r),n||(n=!0,t.apply(this,arguments))}if(!s(t))throw TypeError("listener must be a function");var n=!1;return r.listener=t,this.on(e,r),this},n.prototype.removeListener=function(e,t){var r,n,o,a;if(!s(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(r=this._events[e],o=r.length,n=-1,r===t||s(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(i(r)){for(a=o;a-- >0;)if(r[a]===t||r[a].listener&&r[a].listener===t){n=a;break}if(n<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[e],s(r))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){var t;return t=this._events&&this._events[e]?s(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(s(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},{}],4:[function(e,t,r){"use strict";var n=e("./emitter.js"),s=e("./loader"),o=0;t.exports=function i(e){var t,r={},a=[],u=[],c=0,l=0,f={},d=function(r){if(Array.isArray(r))return r.forEach(d),t;var n,o=!!r.assets&&Array.isArray(r.assets);return n=o?i(m(r,e)):s(m(r,e)),n.once("destroy",_),u.push(n),f[n.id]=n,t},v=function(e){return arguments.length?r[e]?r[e]:f[e]:a},h=function(e){if(v(e))return v(e);var t=null;return Object.keys(f).some(function(r){return t=f[r].find&&f[r].find(e),!!t}),t},p=function(e){return e&&e.split("?")[0].split(".").pop().toLowerCase()},m=function(e,t){if("string"==typeof e){var r=e;e={url:r}}return void 0===e.isTouchLocked&&(e.isTouchLocked=t.isTouchLocked),void 0===e.blob&&(e.blob=t.blob),void 0===e.basePath&&(e.basePath=t.basePath),e.id=e.id||e.url||String(++o),e.type=e.type||p(e.url),e.crossOrigin=e.crossOrigin||t.crossOrigin,e.webAudioContext=e.webAudioContext||t.webAudioContext,e.log=t.log,e},b=function(){return l=u.length,u.forEach(function(e){e.on("progress",g).once("complete",y).once("error",L).start()}),u=[],t},g=function(e){var r=c+e;t.emit("progress",r/l)},y=function(e,n,s){Array.isArray(e)&&(e={id:n,file:e,type:s}),c++,t.emit("progress",c/l),r[e.id]=e.file,a.push(e),t.emit("childcomplete",e),w()},L=function(e){l--,t.listeners("error").length&&t.emit("error",e),w()},_=function(e){f[e]=null,delete f[e],r[e]=null,delete r[e],a.some(function(t,r){if(t.id===e)return a.splice(r,1),!0})},w=function(){c>=l&&t.emit("complete",a,r,e.id,"group")},x=function(){for(;u.length;)u.pop().destroy();return t.off("error"),t.off("progress"),t.off("complete"),a=[],r={},e.webAudioContext=null,l=0,c=0,Object.keys(f).forEach(function(e){f[e].destroy()}),f={},t.emit("destroy",t.id),t};return t=Object.create(n.prototype,{_events:{value:{}},id:{get:function(){return e.id}},add:{value:d},start:{value:b},get:{value:v},find:{value:h},getLoader:{value:function(e){return f[e]}},loaded:{get:function(){return c>=l}},file:{get:function(){return a}},destroy:{value:x}}),e=m(e||{},{basePath:"",blob:!1,touchLocked:!1,crossOrigin:null,webAudioContext:null,log:!1}),Array.isArray(e.assets)&&d(e.assets),Object.freeze(t)}},{"./emitter.js":2,"./loader":6}],5:[function(e,t,r){"use strict";var n=e("./group");n.stats=e("./stats"),t.exports=n},{"./group":4,"./stats":7}],6:[function(e,t,r){"use strict";var n=e("./emitter.js"),s=e("./browser-has-blob.js"),o=e("./stats");t.exports=function(e){var t,r,i,a,u,c,l=e.id,f=e.basePath||"",d=e.url,v=e.type,h=e.crossOrigin,p=e.isTouchLocked,m=e.blob&&s,b=e.webAudioContext,g=e.log,y=function(){switch(a=Date.now(),v){case"json":O();break;case"jpg":case"png":case"gif":case"webp":case"svg":A();break;case"mp3":case"ogg":case"opus":case"wav":case"m4a":R();break;case"ogv":case"mp4":case"webm":case"hls":U();break;case"bin":case"binary":_("arraybuffer");break;case"txt":case"text":_("text");break;default:throw"AssetsLoader ERROR: Unknown type for file with URL: "+f+d+" ("+v+")"}},L=function(e){e&&(c={id:l,file:e,type:v},t.emit("progress",1),t.emit("complete",c,l,v),N())},_=function(e,t){r=t||x,i=new XMLHttpRequest,i.open("GET",f+d,!0),i.responseType=e,i.addEventListener("progress",w),i.addEventListener("load",r),i.addEventListener("error",F),i.send()},w=function(e){e.lengthComputable&&t.emit("progress",e.loaded/e.total)},x=function(){E()&&L(i.response)},E=function(){return i&&i.status<400?(o.update(i,a,d,g),!0):(F(i&&i.statusText),!1)},O=function(){_("json",function(){if(E()){var e=i.response;"string"==typeof e&&(e=JSON.parse(e)),L(e)}})},A=function(){m?k():T()},T=function(){i=new Image,h&&(i.crossOrigin="anonymous"),i.addEventListener("error",F,!1),i.addEventListener("load",j,!1),i.src=f+d},j=function(e){return window.clearTimeout(u),e||!i.error&&i.readyState?void L(i):void F()},k=function(){_("blob",function(){E()&&(i=new Image,i.addEventListener("error",F,!1),i.addEventListener("load",C,!1),i.src=window.URL.createObjectURL(i.response))})},C=function(){window.URL.revokeObjectURL(i.src),L(i)},R=function(){b?D():M("audio")},U=function(){m?_("blob"):M("video")},D=function(){_("arraybuffer",function(){E()&&b.decodeAudioData(i.response,function(e){i=null,L(e)},function(e){F(e)})})},M=function(e){i=document.createElement(e),p||(window.clearTimeout(u),u=window.setTimeout(j,2e3),i.addEventListener("canplaythrough",j,!1)),i.addEventListener("error",F,!1),i.preload="auto",i.src=f+d,i.load(),p&&L(i)},F=function(e){window.clearTimeout(u);var r=e;if(i&&i.tagName&&i.error){var n=["","ABORTED","NETWORK","DECODE","SRC_NOT_SUPPORTED"];r="MediaError: "+n[i.error.code]+" "+i.src}else i&&i.statusText?r=i.statusText:e&&e.message?r=e.message:e&&e.type&&(r=e.type);t.emit("error",'Error loading "'+f+d+'" '+r),P()},N=function(){t.off("error"),t.off("progress"),t.off("complete"),i&&(i.removeEventListener("progress",w),i.removeEventListener("load",r),i.removeEventListener("error",F),i.removeEventListener("load",j),i.removeEventListener("canplaythrough",j),i.removeEventListener("load",C))},P=function(){N(),i&&i.abort&&i.readyState<4&&i.abort(),i=null,b=null,c=null,window.clearTimeout(u),t.emit("destroy",l)};return t=Object.create(n.prototype,{_events:{value:{}},id:{value:e.id},start:{value:y},loaded:{get:function(){return!!c}},file:{get:function(){return c}},destroy:{value:P}}),Object.freeze(t)}},{"./browser-has-blob.js":1,"./emitter.js":2,"./stats":7}],7:[function(e,t,r){"use strict";t.exports={mbs:0,secs:0,update:function(e,t,r,n){var s,o=e.getAllResponseHeaders();if(o){var i=o.match(/content-length: (\d+)/i);i&&i.length&&(s=i[1])}if(s){s=parseInt(s,10);var a=s/1024/1024,u=(Date.now()-t)/1e3;this.secs+=u,this.mbs+=a,n&&this.log(r,a,u)}else n&&console.warn.call(console,"Can't get Content-Length:",r)},log:function(e,t,r){if(e){var n="File loaded: "+e.substr(e.lastIndexOf("/")+1)+" size:"+t.toFixed(2)+"mb time:"+r.toFixed(2)+"s speed:"+(t/r).toFixed(2)+"mbps";console.log.call(console,n)}var s="Total loaded: "+this.mbs.toFixed(2)+"mb time:"+this.secs.toFixed(2)+"s speed:"+this.getMbps().toFixed(2)+"mbps";console.log.call(console,s)},getMbps:function(){return this.mbs/this.secs}}},{}]},{},[5])(5)});